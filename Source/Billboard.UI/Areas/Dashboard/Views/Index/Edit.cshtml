@using Billboard.UI.Core.HtmlHelpers
@model Billboard.UI.Areas.Dashboard.Models.EditEventView

@{
    ViewBag.Title = "";
    Layout = "/Areas/Dashboard/Views/Shared/_ModalLayout.cshtml";
}

@section Head{
    
    <style type="text/css" >
        input.start{ width: 80px; }
        input.end{ width: 80px; }
    </style>
    
    <script src="~/Script/plugins/datepicker/base.js"></script>
    <link href="~/Script/plugins/datepicker/base.css" rel="stylesheet" />
    <script src="~/Script/plugins/timepicker/jquery.timepicker.min.js"></script>
    <link href="~/Script/plugins/timepicker/jquery.timepicker.css" rel="stylesheet" />

    <script src="~/Script/plugins/colorpicker/js/colorpicker.js"></script>
    <script src="~/Script/plugins/colorpicker/js/eye.js"></script>
    <script src="/Script/plugins/colorpicker/js/layout.js"></script>
    <script src="/Script/plugins/colorpicker/js/utils.js"></script>

    <link href="~/Script/plugins/colorpicker/css/layout.css" rel="stylesheet" />
    <link href="~/Script/plugins/colorpicker/css/colorpicker.css" rel="stylesheet" />


    <script type="text/javascript" >
        $(function () {
            $('input#datestart').datepicker({
                'dateFormat': 'm/d/yy',
                'autoclose': true
            });
            
            $('input#dateend').datepicker({
                    'dateFormat': 'm/d/yy',
                    'autoclose': true
            });
            
            $('input#cancel').click(function () {
                parent.$.fancybox.close();
                return false;
            });
            
            //$('span#backgroundColor').jPicker({ window: { expandable: true } });
            //$('span#textColor').jPicker({ window: { expandable: true } });

            $('input#timestart').timepicker();
            $('input#timeend').timepicker();
            
            $('a#getnumber').click(function () {
                var spinner = $('img#spinner');
                spinner.show();
                $.post('/api/getnumber', function (data) {
                    $('input#formatted').val(data.Formatted);
                    $('input#number').val(data.Number);

                    spinner.hide();
                });
            });
            
            //$('input.Ok').live('click', function () {
                
            //});
            
@*            $.jPicker.List[0].color.active.val('ahex', '@Model.Event.BackgroundColor.Replace("#", string.Empty)FF)');
            $.jPicker.List[1].color.active.val('ahex', '@Model.Event.BackgroundColor.Replace("#", string.Empty)FF');*@
            
            $('#backgroundColor').ColorPicker({
                color: '#0000ff',
                onShow: function (colpkr) {
                    $(colpkr).fadeIn(500);
                    return false;
                },
                onHide: function (colpkr) {
                    $(colpkr).fadeOut(500);
                    return false;
                },
                onChange: function (hsb, hex, rgb) {
                    $('#backgroundColor div').css('backgroundColor', '#' + hex);
                }
            });

        });
    </script>


}

    <h2>Edit Event</h2>

    @using (Html.BeginForm())
    {
        <input type="hidden" name="id" value="@Model.Event.Id" />
        
        <p>
            <label>Name</label>
            <input type="text" name="name" value="@Model.Event.Name" />
        </p>
        
        <p>
            <label>Timezone</label>
            @Html.DropDownList("timezone")
        </p>
        
        
        <p>
            <label>Begin and End times</label>
            <input type="text" id="datestart" name="datestart" value="@Model.Event.StartDate" class="date start" />
            <input type="text" id="timestart" name="timestart" value="@Model.Event.StartTime" class="time start" /> 
            
            to
            
            <input type="text" id="dateend" name="dateend" value="@Model.Event.EndDate" class="date end" />
            <input type="text" id="timeend" name="timeend" value="@Model.Event.EndTime" class="time end" />
        </p>
        
       <p>
            <label>Board Colors</label>
            <div style="margin-left: 20px;" >background <div id="backgroundColor"></div></div>
           <div style="margin-left: 20px;" >text <div id="textColor"></div></div>
           
           <input type="hidden" id="backgroundColorValue" name="backgroundColor" value="@Model.Event.BackgroundColor" />
           <input type="hidden" id="textColorValue" name="textColor" value="@Model.Event.TextColor" />
       </p>
        
        <p>
            <label>Number</label>
            <input id="formatted" readonly="readonly" type="text" name="formatted" value="@Model.Event.FormattedNumber" /> <a id="getnumber" href="#">Get Number</a> <img id="spinner" style="display: none;"  src="/Content/images/spinner.gif" />
            <input id="number" type="hidden" name="number" value="@Model.Event.Number" />
        </p>

        <input type="submit" class="btn" value="Save" />
        <input type="submit" id="cancel" class="btn" value="Cancel" />
        
        @Model.Message.Success()
    }